## 可见性问题

主内存中有一个共享变量：boolean flag = false;

存在三个线程：a、b

线程在操作共享变量时，线程会先从主内存复制一份变量到自己的工作内存，然后线程在自己的工作内存进行操作。比如修改了flag的值，再通过工作内存更新到主内存，

线程是不可以访问其他线程的工作内存。并且，线程间对变量值的传递是通过主内存进行中转。

存在问题：当A线程更新了flag，但b线程此时已经加载了flag的旧值到自己的工作内存，此时b线程是看不到更新后的flag，因此这就产生了一个可见性的问题。

### 解决

volatile flag = false ; // 每次读取到volatile变量，一定是最新的数据