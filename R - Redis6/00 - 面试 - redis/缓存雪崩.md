### 缓存雪崩 （很多雪花，说明很多key失效了）

某一时刻大规模的key失效。

### 怎么解决缓存雪崩？

1、构建多级缓存架构

    nginx缓存+redis缓存+其他缓存（ehcache）

2、使用锁或者队列

3、设置过期标志更新缓存

    记录缓存数据是否过期（设置提前量），如果过期会触发通知另外的线程在后台去更新实际key的缓存

4、将缓存失效时间分散

    在原有失效的基础上，添加一个随机值，比如1-5min，这样每一个缓存的过期时间的重复率会降低

在雪崩发生前，使用集群缓存。

在发生缓存雪崩的时候，使用限流和降级。
    
雪崩发生后，开启redis持久化机制，尽快恢复缓存集群。 
    
将key的过期时间加上一个随机数，让key均匀过期。

热点数据可以考虑不失效。