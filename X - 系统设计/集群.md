### 单机结构

当一个系统业务量很小的时候，所有的代码都放在一个项目。

将该项目部署在一台服务器上，整个项目所有的服务都由这台服务器提供。这就是单机结构。

### 什么是集群？

集群中每台服务器就叫做这个集群的一个“节点”，所有节点构成了一个集群。

每个节点提供相同的服务，系统的处理能力就相当于提升了好几倍（有几个节点就相当于提升了这么多倍）

### 集群的生动解释

当单机处理能力到达瓶颈，则增加多个服务器，每个服务器运行相同的业务代码，这就构成了一个“集群”。



### 集群的应用场景？

### 集群优点

系统扩展非常容易。

如果随着系统业务的发展，当前的系统又支撑不住了，那么给这个集群再增加节点就行了。

### 集群缺点

但是，当你的业务发展到一定程度的时候，你会发现一个问题——无论怎么增加节点，貌似整个集群性能的提升效果并不明显了。这时候，你就需要使用微服务结构了。

### 分布式与集群的区别

分布式：一个业务分拆多个子业务，部署在不同的服务器上

集群：同一个业务，部署在多个服务器上。

### 分布式与集群的例子

假设我开了个软件公司，公司就我一个程序员，前端、后端、测试的活儿，都是我干，一个月我能做完一个项目。

后来项目多了，我忙不过来了，为了多赚钱，怎么办呢，我想了两条路

1. 再招一个和我一样强的全栈工程师，我俩每个人独立做项目，这样我们一个月能做完两个项目。我俩就组成了一个**集群**。
2. 招一个前端、一个测试。前端、后端、测试分头干。通过协作，我们半个月能干完一个项目。这时候我们的关系就是**分布式**。

从上面例子你就能看出:

- 集群中的多个服务器都在做相同的事情，并不能缩短处理一件事情的时间。
- 而分布式呢，是把事情拆开，多个服务器分头做事，可以缩短时间。

### 分布式结构

分布式结构就是将一个完整的系统，按照业务功能，拆分成一个个独立的子系统，在分布式结构中，每个子系统就被称为“服务”。这些子系统能够独立运行在web容器中，它们之间通过RPC方式通信。

假设需要开发一个在线商城。按照微服务的思想，我们需要按照功能模块拆分成多个独立的服务，如：用户服务、产品服务、订单服务、后台管理服务、数据分析服务等等。这一个个服务都是一个个独立的项目，可以独立运行。如果服务之间有依赖关系，那么通过RPC方式调用。

### 分布式结构的好处

**（1）**系统之间的耦合度大大降低，可以独立开发、独立部署、独立测试，系统与系统之间的边界非常明确，排错也变得相当容易，开发效率大大提升。

**（2）**系统之间的耦合度降低，从而系统更易于扩展。我们可以针对性地扩展某些服务。假设这个商城要搞一次大促，下单量可能会大大提升，因此我们可以针对性地提升订单系统、产品系统的节点数量，而对于后台管理系统、数据分析系统而言，节点数量维持原有水平即可。

**（3）**服务的复用性更高。比如，当我们将用户系统作为单独的服务后，该公司所有的产品都可以使用该系统作为用户系统，无需重复开发。

### 生动例子

**单体架构**

家里生小宝宝啦，由于自己没有照顾小宝宝的经验，所以请了位经验丰富的月嫂。 这位月嫂从买菜，到做饭，洗衣，拖地，喂奶，哄睡，洗澡，换纸尿裤，擦屁股，做排气操，夜间陪护，给奶妈做月子餐等等，全部都做。 这种叫做**单体架构**。

**集群：**

什么都做，一个月嫂怎么够呢，肯定忙不过来呀，那就请两个月嫂吧，这叫做**集群**。

**高可用：**

有一个月嫂过生日，想请假回去和亲戚打一天麻将。如果只有一个月嫂，她走了，就叫做**服务中断**了。 但是因为做了集群，有两个月嫂，走了一个，另一个还是能用，虽然相比较吃力一些，但是毕竟还是能用的，这个现象叫做**高可用**。

**分布式：**

一个月嫂，一个月的费用基本上都要1万多，还有房贷，还有车贷，生活费用还高，实在是请不起两位啊，那就还是请一位吧。 可是事情那么多，她实在忙不过来，怎么办呢？ 那就把爷爷请过来买菜，把奶奶请过来做饭。 这样服务本来仅仅是由月嫂一人提供的，变成了和宝宝相关的由月嫂负责，采购由爷爷负责，餐饮由奶奶负责。 这就叫做**分布式**了。 

**低耦合：**

做宝宝服务的月嫂去打麻将了，不影响做饭的奶奶。 做采购的爷爷去喝酒了，也不影响月嫂的宝宝服务，这叫做**低耦合**。

**高内聚：**

和宝宝相关的事情都是月嫂在做，月嫂兑奶方式快慢，只会影响自己，对爷爷和奶奶的服务没影响. 这叫做**高内聚。**

高内聚是指一个软件模块是由相关性很强的代码组成，只负责一项任务，也就是常说的单一责任原则。 模块的内聚反映模块内部联系的紧密程度。 一个模块只需做好一件事，不用过分关心其他任务。 高内聚性的好处是可以提高程序的可靠性。

**集群+分布式：**

奶奶一个人做饭，做久了也烦啊，也累啊，也想打麻将呀。 那么就把姥姥也请过来吧。 这样做饭这个服务，就由奶奶和姥姥这个集群来承担啦。她们俩，谁想去汗蒸了，都有另一位继续提供做饭服务。 这就叫做**集群+分布式。**