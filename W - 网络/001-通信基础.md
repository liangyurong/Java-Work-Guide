http协议是一个无状态的协议。因此浏览器是不知道谁在和服务端打交道。因此需要一个机制来告诉服务端，本次操作用户是否登录？是哪个用户在执行操作？该机制的实现需要Cookie和Session的配合。

Cookie，将用户的数据写给用户的浏览器。

Session，将用户的数据写到用户独占的session。

Session对象由服务器创建，开发人员可以调用request对象的getSession方法得到session对象。

### Session是什么？

HTTP 协议是一种无状态协议，即每次服务端接收到客户端的请求时，都是一个全新的请求，服务器并不知道客户端的历史请求记录；Session 和 Cookie 的主要目的就是为了弥补 HTTP 的无状态特性。

客户端请求服务端，服务端会为这次请求开辟一块内存空间，这个对象便是 Session 对象，存储结构为 ConcurrentHashMap。Session 弥补了 HTTP 无状态特性，服务器可以利用 Session 存储客户端在同一个会话期间的一些操作记录。

### Session如何判断是否是同一次会话？

服务器第一次接收到请求时，开辟了一块 Session 空间（创建了Session对象），同时生成一个 sessionId ，并通过响应头的 Set-Cookie：JSESSIONID=XXXXXXX 命令，向客户端发送要求设置 Cookie 的响应； 客户端收到响应后，在本机客户端设置了一个 **JSESSIONID=XXXXXXX **的 Cookie 信息，该 Cookie 的过期时间为浏览器会话结束；

接下来客户端每次向同一个网站发送请求时，请求头都会带上该 Cookie信息（包含 sessionId ）， 然后，服务器通过读取请求头中的 Cookie 信息，获取名称为 JSESSIONID 的值，得到此次请求的 sessionId。

### Session缺点

Session 机制有个缺点，比如 A 服务器存储了 Session，就是做了负载均衡后，假如一段时间内 A 的访问量激增，会转发到 B 进行访问，但是 B 服务器并没有存储 A 的 Session，会导致 Session 的失效。

### Cookie是什么？

HTTP 协议中的 Cookie 包括 Web Cookie 和浏览器 Cookie，它是服务器发送到 Web 浏览器的一小块数据。服务器发送到浏览器的 Cookie，浏览器会进行存储，并与下一个请求一起发送到服务器。通常，它用于判断两个请求是否来自于同一个浏览器，例如用户保持登录状态。

### 创建cookie

当接收到客户端发出的 HTTP 请求时，服务器可以发送带有响应的 Set-Cookie 标头，Cookie 通常由浏览器存储，然后将 Cookie 与 HTTP 标头一同向服务器发出请求

### ip地址

网络上每一个节点都必须有一个独立的 Internet 地址（也叫做IP地址）。现在，通常使用的IP地址是一个 32bit 的数字，也就是我们常说的 IPv4 标准，这 32bit 的数字分成四组，也就是常见的 255.255.255.255 的样式。IPv4 标准上，地址被分为五类，我们亚洲使用的是B类地址，具体的分类请参考其他文档。需要注意的是IP地址是 网络号+主机号 的组合，这非常重要。

### 域名系统

12个阿拉伯数字很难记忆。使用一个名称更容易。用于 TCP/IP 地址的名字被称为域名。w3school.com.cn 就是一个域名，当你键入一个像 http://www.w3school.com.cn这样的域名，域名会被 DNS 程序翻译为数字。

在全世界，数量庞大的 DNS 服务器被连入因特网。DNS 服务器负责将域名翻译为 TCP/IP 地址，同时负责使用新的域名信息更新彼此的系统。

当一个新的域名连同其 TCP/IP 地址一同注册后，全世界的 DNS 服务器都会对此信息进行更新。域名系统是一个分布的数据库，它提供将主机名（就是网址）转换成IP地址的服务。

### 端口号

注意，这个端口号码是用在 TCP与UDP 上的一个逻辑号码，并不是一个硬件端口，我们平时说把某某端口封掉了，也只是在IP层次把带有这个号码的IP包给过滤掉了而已。

### 为什么会有TCP/IP协议

在世界上各地，各种各样的电脑运行着各自不同的操作系统为大家服务，这些电脑在表达同一种信息的时候所使用的方法是千差万别。

计算机使用者意识到，计算机只是单兵作战并不会发挥太大的作用。只有把它们联合起来，电脑才会发挥出它最大的潜力.

于是人们就想方设法的把电脑连接到了一起。但是简单的连到一起是远远不够的，就好像语言不同的两个人互相见了面，完全不能交流信息。

因而他们需要定义一些共通的东西来进行交流，TCP/IP 就是为此而生。TCP/IP 指传输控制协议/网际协议 (Transmission Control Protocol / Internet Protocol)，定义了电子设备（比如计算机）如何连入因特网，以及数据如何在它们之间传输的标准。但TCP/IP 不只是一个协议，而是一个协议族的统称。

### TCP/IP

TCP/IP意味着TCP和IP在一起协同工作。

TCP负责应用软件（比如你的浏览器）和网络软件之间的通信。

IP负责计算机之间的通信。

TCP负责将数据分割并装入IP包，然后在它们到达的时候重新组合它们。

IP负责将包发送至接受者。












